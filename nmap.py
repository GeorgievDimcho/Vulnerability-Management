# metasploitable VM IP 172.28.128.3
# in this script we will run an nmap scan of the VM
import subprocess
# question: nmap nse(nmap scripting engine) uses the CVE database, can it load it locally in case of offline use?
# question: where will the AI scanner/pentester in the network be? in the inside network? bc of firewall 
#IP_ADDR="172.28.128.3" #= target bc /etc/hosts
try:
	if subprocess.check_output(["ping", "-c", "1", "target"]):
		print("The VM is up and running!")
except:
	print("I cannot reach the VM. Check the IP_ADDR and double check if the VM is running.")
file_name = subprocess.check_output(["date"])
file_name = str(file_name).split(' ')
file_name = "reports/"+file_name[1]+"_"+file_name[2]+"_"+file_name[3]+"_"+file_name[len(file_name)-3].replace(":","_")+file_name[len(file_name)-2]
try:
	#if subprocess.check_output(["nmap", "-sT", "-F", "-T5", "-oN", file_name, "target"]):
	if subprocess.check_output(["nmap", "-sV", "-p-", "-Pn", "-n", "--version-all", "--open", "-oN", file_name, "target"]):
		print("The Nmap scan was successful and the report is saved - " + file_name)
except Exception as e: 
	print(e)
	print("The Nmap scan encountered an error")
